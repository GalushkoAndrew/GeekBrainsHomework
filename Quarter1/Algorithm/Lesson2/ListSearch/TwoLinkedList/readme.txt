Задача простая, но интересная и долгая. Нового ничего не узнал.